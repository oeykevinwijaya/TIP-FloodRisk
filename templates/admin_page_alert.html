<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Admin Management</title>
        <link
            href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
            rel="stylesheet"
        />
    </head>
    <body class="font-sans leading-normal tracking-normal bg-white">
        <!-- Menu Button -->
        <button
            id="sidebar-toggle"
            class="text-white focus:outline-none bg-gray-700 p-2.5 fixed top-2.5 left-2.5 z-30"
        >
            <svg class="w-6 h-6 fill-current" viewBox="0 0 24 24">
                <path d="M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h18v2H3v-2z"></path>
            </svg>
        </button>

        <!-- Sidebar -->
        <div
            id="sidebar"
            class="fixed inset-y-0 left-0 z-20 w-64 px-2 space-y-6 transition-transform duration-500 ease-in-out transform -translate-x-full bg-white shadow-md py-7"
            style="will-change: transform"
        >
            <a href="#" class="flex items-center px-4 space-x-2 text-gray-800">
                <span class="mt-10 text-2xl font-medium">Menu</span>
            </a>
            <!-- Sidebar content -->
            <nav class="text-base text-black">
                <a
                    href="admin_page_alert.html"
                    class="flex items-center justify-center px-10 py-5 text-sm border-t border-b border-gray-300 hover:border-l-4 hover:border-gray-700"
                >
                    User Alter Management
                </a>
                <a
                    href="data_management.html"
                    class="flex items-center justify-center px-10 py-5 text-sm border-t border-b border-gray-300 hover:border-l-4 hover:border-gray-700"
                >
                    Data Management
                </a>
                <a
                    href="admin_access.html"
                    class="flex items-center justify-center px-10 py-5 text-sm border-t border-b border-gray-300 hover:border-l-4 hover:border-gray-700"
                >
                    Admin Management
                </a>
                <a
                    href="email.html"
                    class="flex items-center justify-center px-10 py-5 text-sm border-t border-b border-gray-300 hover:border-l-4 hover:border-gray-700"
                >
                    Email
                </a>
                <a
                    href="weather_forecast.html"
                    class="flex items-center justify-center px-10 py-5 mt-20 text-sm border-t border-b border-gray-300 hover:border-l-4 hover:border-gray-700"
                >
                    Home Page
                </a>
            </nav>
        </div>

        <!-- Header -->
        <nav class="fixed z-10 w-full p-4 bg-gray-700">
            <div class="flex flex-wrap items-center justify-between">
                <div class="flex items-center flex-shrink-0 mr-6 text-white">
                    <span class="text-xl font-semibold tracking-tight mx-14"
                        >Hong Kong Flood</span
                    >
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main
            class="p-8 duration-500 ease-in-out transition-padding"
            id="main-content"
            style="will-change: padding"
        >
            <!-- Top black area-->
            <div class="h-[55px] bg-gray-700"></div>
            <!-- User Management title-->
            <div
                class="p-5 mx-10 mt-8 text-xl font-bold border-b border-gray-700"
            >
                User Management
            </div>
            <!-- User Management table-->
            <div class="p-3 mx-32 mt-5 overflow-hidden">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead
                        class="overflow-hidden bg-white border border-gray-200 shadow sm:rounded-xl"
                    >
                        <tr>
                            <th
                                scope="col"
                                class="px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"
                            >
                                Id
                            </th>
                            <th
                                scope="col"
                                class="px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"
                            >
                                Location
                            </th>
                            <th
                                scope="col"
                                class="px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"
                            >
                                Name
                            </th>
                            <th
                                scope="col"
                                class="px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"
                            >
                                Email
                            </th>
                            <th
                                scope="col"
                                class="px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"
                            >
                                Rainfall
                            </th>
                            <th
                                scope="col"
                                class="px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"
                            >
                                Flood
                            </th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                        {% for row in data %}
                        <tr>
                            <td
                                class="px-6 py-4 text-sm text-gray-900 whitespace-nowrap"
                            >
                                {{ row['Id'] }}
                            </td>
                            <td
                                class="px-6 py-4 text-sm text-gray-900 whitespace-nowrap"
                            >
                                {{ row['Location'] }}
                            </td>
                            <td
                                class="px-6 py-4 text-sm text-gray-900 whitespace-nowrap"
                            >
                                {{ row['Name'] }}
                            </td>
                            <td
                                class="px-6 py-4 text-sm text-gray-900 whitespace-nowrap"
                            >
                                {{ row['Email'] }}
                            </td>
                            <td
                                class="px-6 py-4 text-sm text-gray-900 whitespace-nowrap"
                            >
                                {% if row['Rainfall'] %} Registered {% else %}
                                Not Registered {% endif %}
                            </td>
                            <td
                                class="px-6 py-4 text-sm text-gray-900 whitespace-nowrap"
                            >
                                {% if row['Flood'] %} Registered {% else %} Not
                                Registered {% endif %}
                            </td>
                            <td
                                class="px-6 py-4 text-sm font-medium text-right whitespace-nowrap"
                            >
                                <button
                                    type="button"
                                    class="flex items-center text-gray-900 menu-button hover:text-blue-600"
                                    aria-expanded="true"
                                    aria-haspopup="true"
                                >
                                    <ion-icon
                                        name="ellipsis-vertical"
                                    ></ion-icon>
                                </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="flex justify-center mt-5">
                <button
                    id="sendNotificationBtn"
                    class="px-10 py-1 text-sm text-white bg-gray-500 rounded-full hover:bg-gray-700"
                >
                    Send Notification
                </button>
            </div>
            <div>
                &nbsp; &nbsp;
                <!-- Alter history title-->
                <div class="pl-5 mx-10 mt-10 text-xl font-bold">
                    Alert History
                </div>
                <!-- Alert History  search area-->
                <div
                    class="pb-2 mx-10 overflow-hidden border-b border-gray-700"
                >
                    <div class="flex items-center justify-end space-x-3">
                        <span class="text-sm text-gray-700">Show by:</span>
                        <button
                            class="px-10 py-1 text-sm text-white bg-gray-500 rounded-full hover:bg-gray-700"
                        >
                            All
                        </button>
                        <button
                            class="px-10 py-1 text-sm text-white bg-gray-500 rounded-full hover:bg-gray-700"
                        >
                            FLOOD
                        </button>
                        <button
                            class="px-10 py-1 text-sm text-white bg-gray-500 rounded-full hover:bg-gray-700"
                        >
                            RAINFALL
                        </button>
                        <span class="text-sm text-gray-700">or</span>
                        <div class="relative">
                            <input
                                type="text"
                                placeholder="Search By Location"
                                class="py-1 pl-4 pr-10 text-sm border border-gray-300 rounded-full"
                            />
                            <ion-icon
                                name="search-outline"
                                class="absolute text-lg text-gray-500 transform -translate-y-1/2 right-2 top-1/2"
                            ></ion-icon>
                        </div>
                    </div>
                </div>
                <!-- History data-->
                <div class="mx-10 overflow-hidden">
                    <!-- Alert Item -->
                    <div
                        class="flex items-center px-4 py-1 mt-3 space-x-3 border border-gray-500 rounded"
                    >
                        <div class="text-red-500">
                            <ion-icon
                                name="alert-circle"
                                size="large"
                            ></ion-icon>
                        </div>
                        <p class="flex-grow text-sm font-semibold text-red-500">
                            Heavy Rain Advisory In Effect From Early This
                            Afternoon (03/28) Through This Evening (03/28)
                        </p>
                        <div class="text-gray-700">
                            <ion-icon
                                name="chevron-forward-outline"
                                size="large"
                            ></ion-icon>
                        </div>
                    </div>
                    <div
                        class="flex items-center px-4 py-1 mt-3 space-x-3 border border-gray-500 rounded"
                    >
                        <div class="text-red-500">
                            <ion-icon
                                name="alert-circle"
                                size="large"
                            ></ion-icon>
                        </div>
                        <p class="flex-grow text-sm font-semibold text-red-500">
                            Heavy Rain Advisory In Effect From Early This
                            Afternoon (03/28) Through This Evening (03/28)
                        </p>
                        <div class="text-gray-700">
                            <ion-icon
                                name="chevron-forward-outline"
                                size="large"
                            ></ion-icon>
                        </div>
                    </div>
                    <div
                        class="flex items-center px-4 py-1 mt-3 space-x-3 border border-gray-500 rounded"
                    >
                        <div class="text-red-500">
                            <ion-icon
                                name="alert-circle"
                                size="large"
                            ></ion-icon>
                        </div>
                        <p class="flex-grow text-sm font-semibold text-red-500">
                            Heavy Rain Advisory In Effect From Early This
                            Afternoon (03/28) Through This Evening (03/28)
                        </p>
                        <div class="text-gray-700">
                            <ion-icon
                                name="chevron-forward-outline"
                                size="large"
                            ></ion-icon>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <script
            type="module"
            src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"
        ></script>
        <script
            nomodule
            src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"
        ></script>
        <script>
            document
                .getElementById("sendNotificationBtn")
                .addEventListener("click", function () {
                    // Make a request to the /send_email route
                    fetch("/send_email", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            recipient_email: "104341635@student.swin.edu.au",
                        }),
                    })
                        .then((response) => {
                            if (!response.ok) {
                                throw new Error("Failed to send notification");
                            }
                            return response.json();
                        })
                        .then((data) => {
                            console.log(data.message); // Log the response message
                            // Optionally, display a success message to the user
                            alert("Notification sent successfully");
                        })
                        .catch((error) => {
                            console.error("Error sending notification:", error);
                            // Optionally, display an error message to the user
                            alert(
                                "Failed to send notification. Please try again later."
                            );
                        });
                });
        </script>
        <script src="{{ url_for('static', filename='script.js') }}"></script>
    </body>
</html>
