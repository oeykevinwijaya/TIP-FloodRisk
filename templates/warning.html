<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Warning Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">

</head>
<body class="bg-gray-100 font-sans leading-normal tracking-normal">
    <!-- Menu Button -->
    <button id="sidebar-toggle" class="text-white focus:outline-none bg-gray-700 p-2.5 fixed top-2.5 left-2.5 z-30">
        <svg class="fill-current h-6 w-6" viewBox="0 0 24 24">
            <path d="M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h18v2H3v-2z"></path>
        </svg>
    </button>

    <!-- Sidebar -->
    <div id="sidebar" class="transform -translate-x-full fixed inset-y-0 left-0 w-64 space-y-6 py-7 px-2 z-20 bg-white shadow-md transition-transform duration-500 ease-in-out" style="will-change: transform">
        <a href="#" class="text-gray-800 flex items-center space-x-2 px-4">
            <span class="text-2xl font-medium mt-10">Menu</span>
        </a>
        <!-- Sidebar content -->
        <nav class="text-black text-base">
            <a href="warning.html" class="flex items-center justify-center hover:border-l-4 hover:border-gray-700 px-10 py-5 border-t border-b border-gray-300 text-sm">Warning</a>
            <a href="weather_forecast.html" class="flex items-center justify-center hover:border-l-4 hover:border-gray-700 px-10 py-5 border-t border-b border-gray-300 text-sm">Weather Forecast</a>
            <a href="history.html" class="flex items-center justify-center hover:border-l-4 hover:border-gray-700 px-10 py-5 border-t border-b border-gray-300 text-sm">Historical data</a>
            <a href="faq.html" class="flex items-center justify-center hover:border-l-4 hover:border-gray-700 px-10 py-5 border-t border-b border-gray-300 text-sm">FAQ</a>
            <a href="contact.html" class="flex items-center justify-center hover:border-l-4 hover:border-gray-700 px-10 py-5 border-t border-b border-gray-300 text-sm">Contact</a>
            <a href="noti.html" class="flex items-center justify-center hover:border-l-4 hover:border-gray-700 px-10 py-5 border-t border-b border-gray-300 text-sm">Notification Setting</a>
            <a href="#" class="flex items-center justify-center hover:border-l-4 hover:border-gray-700 px-10 py-5 border-t border-b border-gray-300 text-sm mt-20">Admin Page</a>
        </nav>
    </div>

    <!-- Header -->
    <nav class="bg-gray-700 p-4 fixed w-full z-10">
        <div class="flex items-center justify-between flex-wrap">
            <div class="flex items-center flex-shrink-0 text-white mr-6">
                <span class="font-semibold text-xl tracking-tight mx-14">Hong Kong Flood</span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="p-8 transition-padding duration-500 ease-in-out" id="main-content" style="will-change: padding">
        <!-- User Management title-->
        <div class="mx-10 mt-8 p-5 border-b border-gray-700 font-bold text-xl">
            Live Rainfall Map
        </div>
        <!-- Leaflet Map Container -->
        <div id="map" style="width: 60%; height: 500px;"></div>
    </main>

    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script src="{{ url_for('static', filename='mainpage.js') }}"></script>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

    <script>
        var coordinates = JSON.parse('{{ coordinates | tojson | safe }}');
        var rainfallValues = JSON.parse('{{ rainfall_values | tojson | safe }}');

        // Initialize Leaflet map instance
        var map = L.map('map').setView([22.3479, 114.1802], 11);

        // Add OpenStreetMap base layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
        }).addTo(map);

        // Add markers with rainfall values to the map
        for (var i = 0; i < coordinates.length; i++) {
            var coordinate = coordinates[i].split(',').map(parseFloat); // Parse coordinates
            var rainfall = rainfallValues[i]; // Get rainfall value
        
            // Create a div icon with the rainfall value as text
            var icon = L.divIcon({
                className: 'rainfall-label',
                html: '<div>' + rainfall + 'mm</div>',
            });
        
            // Add the text label to the map at the specified coordinates
            L.marker([coordinate[0], coordinate[1]], { icon: icon }).addTo(map);
        
            // console check
            console.log("Label added at:", coordinate);
        }

    </script>
</body>
</html>
